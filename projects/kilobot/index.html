<!DOCTYPE html>
<html lang="en">

  <!-- Head -->
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-BBEHWW29ER"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-BBEHWW29ER');
    </script>
    
    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>KiloBot MultiAgent Reinforcement Learning | Somnath  Kumar</title>
    <meta name="author" content="Somnath  Kumar">
    <meta name="description" content="Deep MultiAgent Reinforcement Learning on " kilobot by havard university>
    <meta name="keywords" content="somnath kumar, website, research">


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous">

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light">

    <!-- Styles -->
    
    <link rel="shortcut icon" href="/assets/img/gen_icon.png">
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="http://localhost:4000/projects/kilobot/">
    
    <!-- Dark Mode -->
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark">

    <script src="/assets/js/theme.js"></script>
    <script src="/assets/js/dark_mode.js"></script>
    
  </head>

  <!-- Body -->
  <body class="fixed-top-nav sticky-bottom-footer">

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Somnath </span>Kumar</a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/">about</a>
              </li>
              

              <!-- Other pages -->
              <li class="nav-item ">
                <a class="nav-link" href="/publications/">publications</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/projects/">projects</a>
              </li>

              <!-- Toogle theme mode -->
              <li class="toggle-container">
                <button id="light-toggle" title="Change theme">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </button>
              </li>
            </ul>
          </div>
        </div>
      </nav>

      <!-- Scrolling Progress Bar -->
      <progress id="progress" value="0">
        <div class="progress-container">
          <span class="progress-bar"></span>
        </div>
      </progress>
    </header>


    <!-- Content -->
    <div class="container mt-5">
      <!-- page.html -->
        <div class="post">

          <header class="post-header">
            <h1 class="post-title">KiloBot MultiAgent Reinforcement Learning</h1>
            <p class="post-description">Deep MultiAgent Reinforcement Learning on "KiloBot" by Havard University</p>
            
              
                  <a href="https://github.com/hex-plex/KiloBot-MultiAgent-RL" class="btn" rel="external nofollow noopener" target="_blank">
                    <i class="fab fa-github"></i> Code and Details
                  </a>
              
            
            <hr>
            
              <img src="/assets/img/projects/kilobot/featured.jpg" alt="KiloBot MultiAgent Reinforcement Learning" class="post-image">
              
                  
                    <p class="post-image-caption"></p>
<center>KiloBot Platform by Havard University</center>
                  
              
            
          </header>

          <article>
            <p>This is an experimentation to learn about Swarm Robotics with help of MultiAgent Reinforcement learning. We have used KiloBot as a platform as these are very simple in the actions space and have very high degree of symmetry. The Main inspiration of this project is this paper<a href="#1">[1]</a></p>

<h2 id="setting-up">Setting Up</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/hex-plex/KiloBot-MultiAgent-RL
<span class="nb">cd </span>KiloBot-MultiAgent-RL
pip <span class="nb">install</span> <span class="nt">--upgrade</span> absl-python <span class="se">\</span>
                      tensorflow <span class="se">\</span>
                      gym <span class="se">\</span>
                      opencv-python <span class="se">\</span>
                      tensorflow_probability <span class="se">\</span>
                      keras <span class="se">\</span>
                      pygame
pip <span class="nb">install</span> <span class="nt">-e</span> gym-kiloBot
</code></pre></div></div>
<p>This should fetch and install the basics packages needed and should install the environment</p>
<h3 id="sample-of-environment">Sample of environment</h3>
<p>These envs are running on a constant <strong>Dummy-actions!!</strong></p>

<table>
  <thead>
    <tr>
      <th><strong>Env with Graph Objective</strong></th>
      <th>Env with Localization Objective</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><img src="https://github.com/hex-plex/KiloBot-MultiAgent-RL/blob/master/images/env_test_graph_compress.gif?raw=true" alt="Output-1"></td>
      <td><img src="https://github.com/hex-plex/KiloBot-MultiAgent-RL/blob/master/images/env_test_localize_compress.gif?raw=true" alt="Output-2"></td>
    </tr>
  </tbody>
</table>

<h2 id="usage">Usage</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python env-test.py <span class="c">## This will help you check the functionality of the environement and should give the sample code to understand the apis as well.</span>
python model-train.py <span class="se">\</span>
        <span class="nt">--headless</span><span class="o">=</span>True <span class="se">\ </span>            <span class="c">## for headless training default False</span>
        <span class="nt">--objective</span><span class="o">=</span><span class="s2">"localization"</span> <span class="se">\ </span> <span class="c">## defines the objective default is graph</span>
        <span class="nt">--modules</span><span class="o">=</span>10 <span class="se">\ </span>               <span class="c">## This defines the no of modules to be initialized default 10</span>
        <span class="nt">--time_steps</span><span class="o">=</span>100000 <span class="se">\ </span>        <span class="c">## This is the total no of steps the agent will take while learning</span>
        <span class="nt">--histRange</span><span class="o">=</span>10 <span class="se">\ </span>             <span class="c">## This is the no of mu values for the histograms</span>
        <span class="nt">--logdir</span><span class="o">=</span><span class="s2">"logs"</span> <span class="se">\ </span>            <span class="c">## This specifies the log location for TensorBoard</span>
        <span class="nt">--checkpoints</span><span class="o">=</span><span class="s2">"checkpoints"</span>   <span class="c">## This is for defining the location where the model is to be saved</span>
        <span class="nt">--load_checkpoint</span><span class="o">=</span><span class="s2">"checkpoints/iter-500"</span> <span class="c">## This loads the specified iteration</span>

python play-model.py <span class="se">\ </span><span class="c">## This should load trained weights and show the performance</span>
        <span class="nt">--load_checkpoint</span><span class="o">=</span><span class="s2">"checkpoints/graphs/10"</span> <span class="se">\ </span><span class="c">## loads this model</span>
        <span class="nt">--modules</span><span class="o">=</span>10  <span class="se">\ </span>                            <span class="c">## no of modules in the env</span>
        <span class="nt">--objective</span><span class="o">=</span><span class="s2">"localization"</span> <span class="se">\ </span>               <span class="c">## Sets the objective function</span>
        <span class="nt">--time_steps</span><span class="o">=</span>10000 <span class="se">\ </span>                       <span class="c">## No of iterations to be run</span>
        <span class="nt">--histRange</span><span class="o">=</span>10                              <span class="c">## Same def as above</span>
</code></pre></div></div>
<h2 id="results">Results</h2>
<p>After a exhaustive amount of training on varies combinations of no_of_modules and task in hand I have obtained results of the following algorithm for these parameters.
I have used <code class="language-plaintext highlighter-rouge">[5, 10, 15, 20, 25, 50]</code> number of modules to carryout the tests.</p>

<p>One may find the Tensorboard log files here:</p>

<p><a href="https://drive.google.com/file/d/11NtimYoXOBGopIxziAojti0k1kfbaVBQ/view?usp=sharing" rel="external nofollow noopener" target="_blank"> log_kilobot [Drive Link] (403MB)</a></p>

<p>and the Model Weights for each parameters here:</p>

<p><a href="https://drive.google.com/file/d/12qpbPIOrC-hLGVn2a8GETrkNL89bt8Dt/view?usp=sharing" rel="external nofollow noopener" target="_blank"> checkpoint_kilobot [Drive Link] (63.3MB)</a></p>
<h3 id="graph-problem">Graph Problem</h3>
<p>The below table is based on the number of modules used but for result tabulation I am considering
<code class="language-plaintext highlighter-rouge">[5, 10, 20, 50]</code>
number of modules. To infer many insights of the algorithm in hand.</p>

<p align="center"><b>Please click on the image to zoom in</b></p>

<table>
  <thead>
    <tr>
      <th>Model Trained on <strong>\</strong> Model Run on</th>
      <th>10</th>
      <th>20</th>
      <th>50</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>10</td>
      <td><img src="https://github.com/hex-plex/KiloBot-MultiAgent-RL/blob/master/images/10trainon10.gif?raw=true" alt="Success1"></td>
      <td><img src="https://github.com/hex-plex/KiloBot-MultiAgent-RL/blob/master/images/10trainon20.gif?raw=true" alt="Success2"></td>
      <td><img src="https://github.com/hex-plex/KiloBot-MultiAgent-RL/blob/master/images/10trainon50.gif?raw=true" alt="Success3"></td>
    </tr>
    <tr>
      <td>20</td>
      <td>-</td>
      <td><img src="https://github.com/hex-plex/KiloBot-MultiAgent-RL/blob/master/images/20trainon20.gif?raw=true" alt="Random1"></td>
      <td>-</td>
    </tr>
    <tr>
      <td>50</td>
      <td>-</td>
      <td>-</td>
      <td><img src="https://github.com/hex-plex/KiloBot-MultiAgent-RL/blob/master/images/50trainon50.gif?raw=true" alt="Random2"></td>
    </tr>
  </tbody>
</table>

<hr>

<p>The policies trained on 20 and 50 module system is completely random in sense it just goes forward.</p>

<p>We can see clearly the policy trained with 10 modules have yield a very good amount of coordination between each other that is the critic model taking in the input image of the system is able to specify the bots and guide them, Hence a very good amount of generalization is found when we use this model with system with different number of modules as can be seen with the 20 module system but the non stationarity of a higher order system makes it complex for the critic to reward or give baseline to the actor, As the</p>
<ul>
  <li>The order of the reward changes drastically.</li>
  <li>The Reading from the histogram becomes Muddy.</li>
  <li>The correlation of a reward to action of a single agent reduces drastically.</li>
</ul>

<hr>

<p>Hence the Model trained with 10 modules is not able to generalize to the 50 module system, <strong>BUT</strong> It looks more promising than the policy trained for the 50 module system itself, hence a curiculum learning based approach seems promising to solve such a transfer learning problem.</p>

<h4 id="plots-for-training-with-10-modules">Plots for Training with 10 modules</h4>

<table>
  <thead>
    <tr>
      <th>Actor Loss</th>
      <th>Critic Loss</th>
      <th>Reward</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><img src="https://github.com/hex-plex/KiloBot-MultiAgent-RL/blob/master/images/actor10.jpg?raw=true" alt="Actor Loss"></td>
      <td><img src="https://github.com/hex-plex/KiloBot-MultiAgent-RL/blob/master/images/critic10.jpg?raw=true" alt="Critic Loss"></td>
      <td><img src="https://github.com/hex-plex/KiloBot-MultiAgent-RL/blob/master/images/reward10.jpg?raw=true" alt="Reward"></td>
    </tr>
  </tbody>
</table>

<hr>

<h4 id="for-5-modules">For 5 modules</h4>
<p>The system can’t comphensate for the negetive reward got by using fuel as the reward got for graphing is much smaller in order than it that it chooses to be stagnent.
<img src="https://github.com/hex-plex/KiloBot-MultiAgent-RL/blob/master/images/5trainon5.gif?raw=true" alt="Failed"></p>

<hr>

<h3 id="localization-problem">Localization Problem</h3>
<p>Here the task was much easier but the training didnt yield any satisfactory result as.</p>
<ul>
  <li>there were a lot of non stationarities and the fact the system was modelled based on a fashion which couldn’t extend more than a small system of at best 10 modules <a href="1">[1]</a>.</li>
  <li>And the fact that the reward of localization couldnt exceed the negetive reward for moving the bot that is the bots choose to stand still to save fuel over exploring in most of the senarios.</li>
</ul>

<p>Below are few runs with <code class="language-plaintext highlighter-rouge">[10, 25]</code>
Number of modules.</p>

<table>
  <thead>
    <tr>
      <th>Localization trained for small n(=10)</th>
      <th>Localization trained for big n(=25)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><img src="https://github.com/hex-plex/KiloBot-MultiAgent-RL/blob/master/images/15loc15.gif?raw=True" alt="loc10"></td>
      <td><img src="https://github.com/hex-plex/KiloBot-MultiAgent-RL/blob/master/images/25loc25.gif?raw=True" alt="loc25"></td>
    </tr>
  </tbody>
</table>

<p>Here it is clearly visible that because of randomness and the fact more number of can cover a larger space of the system exploration is much easier than being greedy to stay at a point and save fuel.</p>

<h2 id="acknowledgment">Acknowledgment</h2>
<p>To Center for Computing and Information Services, IIT (BHU) varanasi to provide the computational power, i.e., The Super Computer on which I was able to train for over <strong>10 Million Timesteps</strong> for about 1.5 months.</p>

<p>For any other query feel free to reachout.</p>
<h2 id="references">References</h2>
<p><a id="1">[1]</a>
<strong>Guided Deep Reinforcement Learning for Swarm Systems</strong> <a href="https://arxiv.org/abs/1709.06011" rel="external nofollow noopener" target="_blank">[arXiv:1709.06011v1]</a> [cs.MA] 18 Sep 2017</p>

          </article>

        </div>

    </div>

    <!-- Footer -->    <footer class="sticky-bottom mt-5">
      <div class="container">
        © Copyright 2024 Somnath  Kumar. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme.

      </div>
    </footer>

    <!-- JavaScripts -->
    <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    <!-- Masonry & imagesLoaded -->
  <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script defer src="/assets/js/masonry.js" type="text/javascript"></script>
    
  <!-- Medium Zoom JS -->
  <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
  <script defer src="/assets/js/zoom.js"></script><!-- Load Common JS -->
  <script defer src="/assets/js/common.js"></script>

    <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    
    

<!-- Scrolling Progress Bar -->
<script type="text/javascript">
  /*
   * This JavaScript code has been adapted from the article 
   * https://css-tricks.com/reading-position-indicator/ authored by Pankaj Parashar, 
   * published on the website https://css-tricks.com on the 7th of May, 2014.
   * Couple of changes were made to the original code to make it compatible 
   * with the `al-foio` theme.
   */
  const progressBar = $("#progress");
  /*
   * We set up the bar after all elements are done loading.
   * In some cases, if the images in the page are larger than the intended
   * size they'll have on the page, they'll be resized via CSS to accomodate
   * the desired size. This mistake, however, breaks the computations as the
   * scroll size is computed as soon as the elements finish loading.
   * To account for this, a minimal delay was introduced before computing the
   * values.
   */
  window.onload = function () {
    setTimeout(progressBarSetup, 50);
  };
  /*
   * We set up the bar according to the browser.
   * If the browser supports the progress element we use that.
   * Otherwise, we resize the bar thru CSS styling
   */
  function progressBarSetup() {
    if ("max" in document.createElement("progress")) {
      initializeProgressElement();
      $(document).on("scroll", function() {
        progressBar.attr({ value: getCurrentScrollPosition() });
      });
      $(window).on("resize", initializeProgressElement);
    } else {
      resizeProgressBar();
      $(document).on("scroll", resizeProgressBar);
      $(window).on("resize", resizeProgressBar);
    }
  }
  /*
   * The vertical scroll position is the same as the number of pixels that
   * are hidden from view above the scrollable area. Thus, a value > 0 is
   * how much the user has scrolled from the top
   */
  function getCurrentScrollPosition() {
    return $(window).scrollTop();
  }

  function initializeProgressElement() {
    let navbarHeight = $("#navbar").outerHeight(true);
    $("body").css({ "padding-top": navbarHeight });
    $("progress-container").css({ "padding-top": navbarHeight });
    progressBar.css({ top: navbarHeight });
    progressBar.attr({
      max: getDistanceToScroll(),
      value: getCurrentScrollPosition(),
    });
  }
  /*
   * The offset between the html document height and the browser viewport
   * height will be greater than zero if vertical scroll is possible.
   * This is the distance the user can scroll
   */
  function getDistanceToScroll() {
    return $(document).height() - $(window).height();
  }

  function resizeProgressBar() {
    progressBar.css({ width: getWidthPercentage() + "%" });
  }
  // The scroll ratio equals the percentage to resize the bar
  function getWidthPercentage() {
    return (getCurrentScrollPosition() / getDistanceToScroll()) * 100;
  }
</script>

  </body>
</html>
